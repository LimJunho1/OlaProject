<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head>
	<meta charset="UTF-8">
	<!-- Custom CSS for Board View -->
	<link href="/css/boardView.css" rel="stylesheet" />
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
	<header th:include="header :: body"></header>

	<div class="container mt-3">
		<!-- 좋아요 버튼 Section -->
		<div class="like-section">
			<form th:action="@{/likeCommunity}" method="post">
				<input type="hidden" name="communityNo" th:value="${community.communityNo}" />
				<button type="submit" class="btn btn-success">좋아요</button>
			</form>

			<!-- 좋아요 취소 버튼 -->
			<form th:action="@{/unlikeCommunity}" method="post">
				<input type="hidden" name="communityNo" th:value="${community.communityNo}" />
				<button type="submit" class="btn btn-warning">좋아요 취소</button>
			</form>
		</div>

		<!-- 게시글 내용 Section -->
		<table class="table table-hover styled-table">
			<tbody>
				<tr>
					<th>게시글 제목</th>
					<td><span th:text="${community.title}"></span></td>
				</tr>
				<tr>
					<th>게시글 내용</th>
					<td>
						<p th:text="${community.content}"></p>
					</td>
				</tr>
				<tr>
					<th class="author-th">작성자</th>
					<td class="author-td"><span th:text="${community.member.name}"></span></td>
					<th class="date-th">등록 날짜</th>
					<td class="date-td"><span
							th:text="${#dates.format(community.regDate, 'yyyy-MM-dd HH:mm:ss')}"></span></td>
				</tr>
				<tr>

				</tr>
			</tbody>
		</table>

		<!-- 댓글 Section -->
		<div class="comments-section">
			<h2>댓글</h2>
			<div th:each="reply : ${community.replies}">
				<p>
					<span th:text="${reply.member.name}"></span>
					: <span th:text="${reply.content}"></span>
					<span th:text="${#dates.format(reply.regDate, 'yyyy-MM-dd HH:mm:ss')}"></span>
				</p>

				<!-- 삭제 버튼 추가 -->
				<form th:action="@{/deleteReply}" method="post">
					<input type="hidden" name="replyNo" th:value="${reply.replyNo}" />
					<button type="submit" class="btn btn-danger">댓글 삭제</button>
				</form>
			</div>

			<h3>댓글 작성</h3>
			<form th:action="@{/addReply}" method="post">
				<input type="hidden" name="communityNo" th:value="${community.communityNo}" />
				<textarea name="replycontent" class="form-control"></textarea>
				<button type="submit" class="btn btn-primary mt-2">댓글 작성</button>
			</form>
		</div>


		<!-- 게시글 관리 Section -->
		<div class="management-section">
			<form th:action="@{/editBoard/{communityNo}(communityNo=${community.communityNo})}" method="get">
				<button type="submit" class="btn btn-info">게시글 수정</button>
			</form>
			<form th:action="@{/deleteBoard}" method="post">
				<input type="hidden" name="communityNo" th:value="${community.communityNo}" />
				<button type="submit" class="btn btn-danger" onclick="return confirm('정말 삭제하시겠습니까?');">게시글 삭제</button>
			</form>
			<button type="button" class="btn btn-secondary" onclick="goBack()">뒤로 가기</button>
		</div>

		<script>
			function goBack() {
				window.history.back();
			}
		</script>
	</div>

	<th:block th:include="footer.html"></th:block>
	<!-- Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>

</html>